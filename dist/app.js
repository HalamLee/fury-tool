#!/usr/bin/env node
"use strict";var J=Object.create;var M=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var B=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of A(t))!q.call(r,i)&&i!==e&&M(r,i,{get:()=>t[i],enumerable:!(o=z(t,i))||o.enumerable});return r};var g=(r,t,e)=>(e=r!=null?J(V(r)):{},B(t||!r||!r.__esModule?M(e,"default",{value:r,enumerable:!0}):e,r));var G=require("commander");var p=class{Prompt;Logger;Spinner;Launcher;CommonUtil;FileUtil;constructor({prompt:t,logger:e,spinner:o,launcher:i,utils:u}){this.Prompt=t,this.Logger=e,this.Spinner=o,this.Launcher=i,this.CommonUtil=u.CommonUtil,this.FileUtil=u.FileUtil}async invoke(){try{await this.prepare(),await this.execute(),await this.finalize()}catch(t){let e=t;this.Logger.errorD(e),await this.rollback()}}};var N=g(require("moment")),n=class r{static instance;logLevel;constructor(t){let e={error:0,info:1,warn:2,debug:3,trace:4};this.logLevel=t?e[t]:2}static getInstance(t){return r.instance?this.instance.debug("Get Logger Instance"):(r.instance=new r(t),this.instance.debug("New Logger Instance"),this.instance.debug(`Level: ${t}`)),r.instance}formatMessage(t,e,o){return`${(0,N.default)().format("YYYY.MM.DD HH:mm:ss")} | ${t}${e}\x1B[0m | ${o}`}debug(t){this.logLevel>=3&&(typeof t=="object"&&(t=JSON.stringify(t,null,2)),console.log(this.formatMessage("\x1B[36m","DEBUG",t)))}info(t){this.logLevel>=1&&console.info(this.formatMessage("\x1B[32m","INFO",t))}warn(t){this.logLevel>=2&&console.warn(this.formatMessage("\x1B[33m","WARN",t))}error(t){this.logLevel>=0&&console.error(this.formatMessage("\x1B[31m","ERROR",t))}errorD(t){this.logLevel>=4&&console.error(this.formatMessage("\x1B[31m","ERROR_D",`{
  type: '${t.title}'
  reason: '${t.context}'
}`))}system(t){this.logLevel>=0&&console.log(t)}space(){console.log()}logo(){console.log(`
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2880\u28E0\u28E4\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2880\u28FE\u28FF\u28FF\u280F\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u28A0\u28FF\u28FF\u28FF\u284F\u2840\u28C0\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u287F\u2803\u2800\u28C0\u28C0\u2840\u2800\u2800\u2800\u2800\u2800\u2880\u28C0\u2840\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2880\u28F8\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28F6\u28FE\u28FF\u28FF\u28D7\u2800\u2800\u2880\u28E0\u28F6\u28FF\u28FF\u2847\u2800\u2800\u2880\u28FE\u28FE\u28FE\u28FE\u28FE\u28FE\u2802\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2880\u285E\u2801\u28FD\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28F7\u28F6\u28FE\u28FF\u28FF\u28FF\u283F\u280F\u2801\u2800\u2800\u28B8\u28FF\u28FF\u2809\u2809\u2809\u2809\u28A0\u28E4\u28E4\u2800\u2800\u28E4\u28E4\u2844\u2800\u28E0\u28E4\u28C4\u28E0\u28E4\u28A0\u28E4\u28E4\u2800\u2800\u28E4\u28E4\u2844\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2880\u28FE\u2805\u2828\u28FF\u28FF\u28BF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u284F\u2808\u2818\u28FB\u28FF\u2809\u2808\u2800\u2800\u2800\u2800\u2800\u2800\u28FD\u28FF\u28FF\u28FE\u28FE\u284E\u2800\u28FC\u28FF\u28DF\u2800\u2890\u28FF\u28FF\u2803\u2880\u28FF\u28FF\u283F\u281B\u2813\u2898\u28FF\u28FF\u2800\u28B0\u28FF\u285F\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2818\u28FF\u28E7\u28C0\u2819\u2821\u28FF\u28FF\u28FF\u284F\u28FF\u28FF\u287F\u2801\u2800\u2880\u28FD\u28FF\u28E7\u28C0\u2800\u2800\u2800\u2800\u2800\u28B0\u28FF\u28FF\u2801\u2801\u2801\u2801\u2880\u28FF\u28FF\u2847\u2800\u28FC\u28FF\u28DF\u2800\u28B0\u28FF\u28FF\u2801\u2800\u2800\u2800\u28FF\u28FF\u28E0\u28FF\u285F\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2819\u28BF\u28FF\u28FF\u28FF\u28FF\u28FF\u28FF\u28E7\u28CD\u28C9\u28C1\u28C0\u28E4\u28FE\u28FF\u287F\u283F\u280B\u2800\u2800\u2800\u2800\u2800\u28FE\u28FF\u286F\u2800\u2800\u2800\u2800\u2818\u28FF\u28FF\u287F\u287F\u28BB\u28FF\u28DF\u2800\u28FD\u28FF\u284F\u2800\u2800\u2800\u2800\u28FB\u28FF\u28FF\u280F\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2808\u2809\u281B\u281B\u281F\u283F\u283F\u283B\u281F\u283F\u283B\u283B\u281B\u280B\u2801\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2801\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u28C0\u28F4\u28FE\u287F\u2803\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2839\u281B\u2809\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800\u2800
`)}};var l=require("fs"),F=require("path");var a=class{logger;title;message;context;constructor(t,e,o){this.logger=n.getInstance(),this.title=`${t}Exception`,this.message=e,this.context=o}};var Y="NoData",c=class extends a{constructor(t){super(Y,t,new Error(`${t} is undefined`)),this.logger.error(`${this.convertMessage(t)} is not exist.`)}convertMessage(t){return{projectName:"[Project Name] value",packageManager:"[Package Manager] value",useTypescript:"[Use Typescript] value",useFramework:"[Use Framework] value",useGit:"[Use Git] value",usePrettier:"[Use Prettier] value",useEslint:"[Use Eslint] value",frameworkType:"[Framework Type] value",remoteUrl:"[Remote URL] value"}[t]}};var K="OperationFail",f=class extends a{constructor(t,e){super(K,t,e),this.logger.error(`${this.convertMessage(t)} Faild.`)}convertMessage(t){return{projectBuild:"Project Build",createDirectory:"Create Project Directory"}[t]}};var m=class r{constructor(){}static makePath(t,e){return(0,F.join)(t,e)}static async checkExist(t){return(0,l.existsSync)(t)}static async createDirectory(t,e,o){try{let i=(0,F.join)(t,e);return(0,l.mkdirSync)(i,{recursive:o!=null&&o.recursive?o.recursive:!1}),await this.checkExist(i),i}catch(i){throw new f("createDirectory",i)}}static async createFile(t,e,o){let i=(0,F.join)(t,e);return(0,l.writeFileSync)(i,o),this.checkExist(i)}static async createStructure(t,e){for(let o in t){let i=t[o];typeof i=="string"&&await this.createFile(e,`${o}.${i}`,""),typeof i=="object"&&(await this.createDirectory(e,o),await r.createStructure(i,this.makePath(e,o)))}}};var h=class{constructor(){}static validateRequireFields(t,e){e.forEach(o=>{if(t[o]===void 0)throw new c(o);return!0})}};var s=class{logger;FileUtil;projectInfo;sWorkDir;constructor(t){this.logger=n.getInstance(),this.FileUtil=m,this.projectInfo=t,this.sWorkDir=process.cwd()}setWorkDir(t){this.sWorkDir=t}};var C={name:"moduleName",version:"1.0.0",description:"JavaScritp Project setup from fury",main:"src/index.js",scripts:{dev:"node src/index.js"},keywords:[],author:"",license:"ISC",dependencies:{}};var R={name:"moduleName",version:"1.0.0",description:"TypeScript Project setup from fury",main:"dist/index.js",scripts:{build:"npx tsc",dev:"ts-node src/index.ts"},keywords:[],author:"",license:"ISC",devDependencies:{"@types/node":"^20.12.7","ts-node":"^10.9.2",typescript:"^5.4.5"}};var O={compilerOptions:{target:"ES2020",module:"commonjs",outDir:"./dist",rootDir:"./src",esModuleInterop:!0,declaration:!0}};var U={default:{src:{index:"js",utils:{projectUtil:"js"}}},typescript:{src:{index:"ts",utils:{projectUtil:"ts"}}}};var d=class extends s{constructor(t){super(t)}async setup(){let t=await this.FileUtil.createDirectory(this.sWorkDir,this.projectInfo.projectName),e=this.projectInfo.useTypescript?R:C,o=this.projectInfo.useTypescript?U.typescript:U.default;e.name=this.projectInfo.projectName,await this.FileUtil.createFile(t,"package.json",JSON.stringify(e,null,2)),this.projectInfo.useTypescript&&await this.FileUtil.createFile(t,"tsconfig.json",JSON.stringify(O,null,2)),await this.FileUtil.createStructure(o,t),this.setWorkDir(t)}getWorkDir(){return this.sWorkDir}getFactory(){var t;switch((t=this.projectInfo)==null?void 0:t.frameworkType){case"react":return new y(this.projectInfo);case"vue":return new x(this.projectInfo);case"express":return new v(this.projectInfo);default:return this}}};var y=class extends s{async setup(){}getWorkDir(){return""}};var x=class extends s{async setup(){}getWorkDir(){return""}};var v=class extends s{async setup(){}getWorkDir(){return""}};var S=[{type:"text",name:"projectName",message:"Enter the project name:",initial:"demo"},{type:"select",name:"packageManager",message:"Select a package manager:",choices:[{title:"\x1B[31mnpm\x1B[0m",value:"npm"},{title:"\x1B[34myarn\x1B[0m",value:"yarn"},{title:"\x1B[33mpnpm\x1B[0m",value:"pnpm"}]},{type:"confirm",name:"useTypescript",message:"Use TypeScript?",initial:!1},{type:"confirm",name:"useFramework",message:"Use Framework?",initial:!1},{type:"confirm",name:"useGit",message:"Use Git?",initial:!1},{type:"confirm",name:"usePrettier",message:"Use Prettier?",initial:!1},{type:"confirm",name:"useEslint",message:"Use ESLint?",initial:!1}],E=[{type:"select",name:"frameworkType",message:"Select a framework:",choices:[{title:"\x1B[34mReact\x1B[0m",value:"react"},{title:"\x1B[32mVue\x1B[0m",value:"vue"}]}],D=[{type:"text",name:"remoteUrl",message:"Enter the remote repo URL:",validate:r=>{let t=new RegExp(/https:\/\/github\.com\/[a-zA-Z0-9]+\/[a-zA-Z0-9]/);return r===""?!1:!!t.test(r)}}];var b=class extends p{projectInfo={};sWorkDir="";async prepare(){let t=await this.Prompt.call(S);Object.assign(this.projectInfo,t);let e=S.map(o=>String(o.name));if(this.CommonUtil.validateRequireFields(this.projectInfo,e),this.projectInfo.useFramework){let o=await this.Prompt.call(E);this.CommonUtil.validateRequireFields(o,E.map(i=>String(i.name))),Object.assign(this.projectInfo,o)}if(this.projectInfo.useGit){let o=await this.Prompt.call(D);this.CommonUtil.validateRequireFields(o,D.map(i=>String(i.name))),Object.assign(this.projectInfo,o)}this.Logger.space()}async execute(){let t=new d(this.projectInfo).getFactory();await t.setup(),this.sWorkDir=t.getWorkDir(),this.Logger.system(`\u2728 Creating project \x1B[35min\x1B[0m ${this.sWorkDir}`),this.Logger.space()}async finalize(){let t=this.Spinner.get();if(this.projectInfo.useGit){let i=t.start("\u{1F334}  Setup Git...");await this.FileUtil.createFile(this.sWorkDir,".gitignore","node_modules");try{await this.Launcher.run("git",["init"],this.sWorkDir),await this.Launcher.run("git",["remote","add","origin",this.projectInfo.remoteUrl],this.sWorkDir),i.succeed("\u{1F334}  Setup Git")}catch(u){i.fail(),this.Logger.error(u.message)}}if(this.projectInfo.usePrettier){let i=t.start("\u{1F3A8}  Setup Prettier...");await this.FileUtil.createFile(this.sWorkDir,".prettierrc.yaml",""),i.succeed("\u{1F3A8}  Setup Prettier")}let e=t.start("\u{1F4E6}  Installing dependencies..."),o=await this.Launcher.run(this.projectInfo.packageManager,["install"],this.sWorkDir);e.succeed(`\u{1F4E6}  Installing dependencies
`),this.Logger.system(o),this.Logger.space(),this.Logger.system(`\u{1F389}  Successfully created project \x1B[33m${this.projectInfo.projectName}\x1B[0m.`),this.Logger.system(`\u{1F449}  Get started with the following commands:
    $ \x1B[33mcd\x1B[0m ${this.projectInfo.projectName}
    $ code .`)}async rollback(){}};var j=class extends p{async prepare(){let t=this.Spinner.get();t.start("\u{1FAE0}  Check consistency..."),this.Logger.error("\u{1F6A8}  This Project not use git"),t.succeed("\u{1FAE0}  Check consistency")}async execute(){}async finalize(){}async rollback(){}};var P=class{constructor(){}static async call(t){let{default:e}=await import("update-notifier"),o=e({pkg:t,updateCheckInterval:0});o.update&&o.notify({message:`New Version! \x1B[31m{currentVersion}\x1B[0m \u2192 \x1B[32m{latestVersion}\x1B[0m.
 \x1B[35mChangelog:\x1B[0m https://github.com/jujoycode/fury-tool

 Run "{updateCommand}" to update.`})}};var T=g(require("prompts"));var w=class{prompt;constructor(){this.prompt=T.default}async call(t){return await this.prompt(t)}};var k=class r{static instance;ora=null;constructor(){import("ora").then(t=>{this.ora=t.default({spinner:"arc"})}).catch(t=>{throw new c(t)})}static getInstance(){return r.instance||(r.instance=new r),r.instance}get(){if(!this.ora)throw new c("Spinner instance is not initialized yet.");return this.ora}};var I=class r{static instance;execa=null;constructor(){import("execa").then(t=>{this.execa=t})}static getInstance(){return r.instance||(r.instance=new r),r.instance}async run(t,e,o){if(!this.execa)throw new Error("Launcher instance is not initialized yet.");let{stdout:i}=await this.execa.execa(t,e,{cwd:o});return i}};var $="info";var L={name:"fury-tool",version:"0.0.1",description:"CLI tool for JavaScript developers",main:"dist/app.js",bin:{fury:"./dist/app.js"},scripts:{exportType:"npx tsc",build:"rm -rf dist && rm -rf types && pnpm exportType && node ./scripts/build.mjs",dev:"node ./dist/app.js"},keywords:[],author:"",license:"ISC",devDependencies:{"@types/node":"^20.12.7","@types/prompts":"^2.4.9","@types/update-notifier":"^6.0.8","ts-node":"^10.9.2",typescript:"^5.4.5"},dependencies:{commander:"^12.1.0",esbuild:"^0.22.0",execa:"^9.3.0",moment:"^2.30.1",ora:"^8.0.1",prompts:"^2.4.2","update-notifier":"^7.0.0"}};var W=class{program;prompt;spinner;launcher;logger;constructor(){this.program=new G.Command,this.prompt=new w,P.call(L),this.spinner=k.getInstance(),this.launcher=I.getInstance(),this.logger=n.getInstance($),this.configureCommands()}configureCommands(){this.program.name(L.name).option("no option","Start create project").option("-g, --git","Start git management",!1).version(L.version).description(L.description).action(async t=>{let e=this.getCommand(t);e&&await e.invoke()})}getCommand(t){let e={prompt:this.prompt,logger:this.logger,spinner:this.spinner,launcher:this.launcher,utils:{CommonUtil:h,FileUtil:m}};switch(!0){case t.git:return new j(e);default:return new b(e)}}run(){this.logger.logo(),this.program.parse(process.argv)}};new W().run();
